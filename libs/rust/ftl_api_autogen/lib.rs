//! DO NOT EDIT: This file is auto-generated by ftl_idlc.
#![no_std]

pub use ftl_autogen::*;

pub mod apps {
    
    pub mod ping {
        pub struct Environ {
            pub vsyscall: &'static ftl_types::syscall::VsyscallPage,
            pub depends: Depends,
        }

        impl Environ {
            pub fn from_environ_ptr(environ_ptr: ftl_types::environ::EnvironPtr) -> Self {
                use ftl_types::syscall::VsyscallPage;

                #[allow(unused_variables)]
                let environ_json: EnvironJson = serde_json::from_slice(environ_ptr.envion_as_bytes())
                    .expect("failed to parse environ JSON");

                let depends = Depends {
                    
                    ping_server: {
                        use ftl_api::channel::Channel;
                        use ftl_api::handle::OwnedHandle;
                        use ftl_types::handle::HandleId;

                        let handle_id = HandleId::from_raw(environ_json.depends.ping_server);
                        let handle = OwnedHandle::from_raw(handle_id);
                        Some(Channel::from_handle(handle))
                    },
                    
                };

                // SAFETY: Vsyscall page will be always available at the same
                //         address.
                let vsyscall = unsafe { &*(environ_json.vsyscall as *const VsyscallPage) };

                Self {
                    vsyscall,
                    depends,
                }
            }
        }

        pub struct Depends {
            
            pub ping_server: Option<ftl_api::channel::Channel>,
            
        }

        #[derive(serde::Serialize, serde::Deserialize)]
        struct EnvironJson {
            pub vsyscall: usize,
            pub depends: DependsJson,
        }

        #[derive(serde::Serialize, serde::Deserialize)]
        struct DependsJson {
            
            pub ping_server: i32 /* Handle ID */,
            
        }
    }
    
    pub mod pong {
        pub struct Environ {
            pub vsyscall: &'static ftl_types::syscall::VsyscallPage,
            pub depends: Depends,
        }

        impl Environ {
            pub fn from_environ_ptr(environ_ptr: ftl_types::environ::EnvironPtr) -> Self {
                use ftl_types::syscall::VsyscallPage;

                #[allow(unused_variables)]
                let environ_json: EnvironJson = serde_json::from_slice(environ_ptr.envion_as_bytes())
                    .expect("failed to parse environ JSON");

                let depends = Depends {
                    
                };

                // SAFETY: Vsyscall page will be always available at the same
                //         address.
                let vsyscall = unsafe { &*(environ_json.vsyscall as *const VsyscallPage) };

                Self {
                    vsyscall,
                    depends,
                }
            }
        }

        pub struct Depends {
            
        }

        #[derive(serde::Serialize, serde::Deserialize)]
        struct EnvironJson {
            pub vsyscall: usize,
            pub depends: DependsJson,
        }

        #[derive(serde::Serialize, serde::Deserialize)]
        struct DependsJson {
            
        }
    }
    
}